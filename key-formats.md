# SSH Key File Formats

CS338 Computer Security
key-formats.md
Kezia Sharnoff
October 1, 2025

## Private Key

The private key file (`id_rsa_hw`) contains: 
> -----BEGIN RSA PRIVATE KEY-----
> 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
> -----END RSA PRIVATE KEY-----


From reading the [RSA RFC](https://datatracker.ietf.org/doc/html/rfc8017#appendix-A.1.2), I would expect to see the following items in the private key file:

| Name | Variable/Info |
---  | --- | 
| version | 0 or 1|
| modulus | `n` |
| publicExponent  | `e` |
| privateExponent  | `d` |
| prime1 | `p` |
| prime2 | `q` |
| exponent1| `d mod (p-1)` |
| exponent2 | `d mod (q-1)` |
| coefficient| `(inverse of q) mod p` |
| otherPrimeInfos| (Only if version 1) |

In order to decode this key, I used [Lapo Luchini's ASN.1 decoder](https://lapo.it/asn1js/) and simply pasted the contents of the `id_rsa_hw` file. This decoding was easy because this file used the PEM format thanks to the original arguments used with `ssh-keygen`. This file format is recognizable as PEM because of the first line:
> -----BEGIN RSA PRIVATE KEY-----

The decoded integers are the following:

* The version should be 0 or 1 if "multi-prime is used" ([RSA RFC](https://datatracker.ietf.org/doc/html/rfc8017#appendix-A.1.2)). The version here is 0.

* The modulus, `n`, is the two primes multiplied together. It is
4942271319712007060511629267369524954009153979856328868249170733762659518883204039555779518501157601924261775973735309200497484161231857797260279014732622554291967333743460534270542285560322138792559576342307077567929886182525033547497304837123743685822183064523619388747079115449222957286204134404676406578828625344133770876650291763579531228433965989115802151653502695088658803062481171341557788514807377145708007395209159911762824841744916868901296977991701680743551930960416389476860180808691039032860516495848496338328611941940491524269339553023877920855593861592463735757813567708996732231580021860988806714498474659842784047458731387214780271675709524721714752012139716622256836725386298247499677842800381728502432257208507483060325366103399705254179668207217126377078821253275633561284927388301417576728380414120008730312366195656738162428062011010242342009158894985258138671971837607392704546827950242383310778319433. 

* publicExponent is the RSA value `e`, 65537.

* privateExponent is the RSA value `d`, 3205233042429763890518726501838761602152235708162313592126501116882285083709855826376539922102853373736773094041711885605821819267052774035383884507426044164747722471063648062744722199111499944536676376295483127361181072560780345466977096105898507375658029003333191859253812405876654765301059467546606669649510247081827329044208116801614672868793641094883637317114436502271285916452761603758643677392081693559730037052635532961985677468432857800615100255665979467286908323806563858367294132560758874760272512976126248493898137458860104101489430451485203219360774749350921749494578556328526406861297305997109070281526082309192454417592531506346342486069156345070833538039742734155150835456587054314764011149368153438501768771470413119926699623855161703517389784154733866619223440206866584655042770305313593497939966169600027685498454753412945302665039969603361696693671612576836000588796509673640387245195413233813822821938545. 

* prime1, `p`, is one of the secret primes used to construct the key. It is 2289736367349136221979683587970163727236181031697834443045816071488267444169032833884795415604333849189680961292827085153779276566394690441788978549682219501200223940680958422726517463721649379304484367804390315829782385904146694924833251371203198419090030633948927442326459347332065507505384917692015917266550935707167599674519450902871392531748303382560604280680642539460742992715920913941813798051870443851528714019744704393196817967213611331079780482778243837.

* prime2, `q`, is the other secret prime used to construct the key. It is 2158445570497599354711788371639213042800044431203764566255253941422044347204675067569765159411144545538951208847263923839050237891021727319922549345119228721564516241546257931950078766153359876102012581223260940665224311553162689072903068178208758476957482446498388670157644760514131162496944311401310731584254441196554268402903736995189582885850200129894616897039517314461087799129758713264879207494707494741984927974876542628409789614897426867919056337016347709. 

* exponent1 is `d mod (p-1)`, a RSA value that we have not used in the class so far. Its value is 1760354713656197698162051323372700907835192048493147205591703049604595193165032261703853045077198544202848394567024622510538609484684933364504595636445650999709679772513390758336139622039692143007102016751212384806805095042196487843320923605567437513860127767391194427294790030293210256735261288705803164494486609023996208395267750030382457431865026869254254034851979406300708541556550883454511012326525356874121095806717379966297231690160639133870252523380408253.

* exponent2 is `d mod (q-1)`, another value that we have not used. Its value is 126732968480015293909256780964458119668196148302059692249419673872652496269948115721019520780842641732668328602839183650955419311299748336467369117903150771634042731548133123611759816472498417737164417238309780729660850372409021278858217592348555817619549147109660185891429528944846067309889706734703201170883792204775025173785397255862940246650770863784342979077590714040103542289871546281386929374851373113922791748894898088623538923632837917325366263100827105.

* coefficient is `q^(-1) mod p`, also known as an integer `QRC` where `q * QRC == 1 (mod p)`. We also haven't used this value yet. It is 849295397212227763065212461277614199435877252486106449276626353121088708955694416819307028570178365602139054160036090292867262410167554164403822594818950341945633020798421876718384483373992391538126358124503213772137374084450643183222145202801507870289360766499978072901708504547956780616453371803332907809151521377212826417748876137460380398892567476840113195882946059918073238415307509341482612566307450397718375641988302824730146273874889042135672791658856316. 

* There is no otherPrimeInfos because this is version 0, without any multi-primes. 

***

## Public Key

The public key file (`id_rsa_hw.pub`) contains: 
> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDZx+u4JSxeDHpR+e4Upz2ih3H/qjUmZVf+hFiPSUlFVdQFFPe2qvT+hQRYUktAfa0AvhdUgb+c/pA5kVIUfKfu3U5iVpqEUDFaY4irTL976KtOZs0Zf2/1X/aK13U+SZbSDivVt+CQBrfcvy5uCmPxSjg+riSMIuFG+G2dDEUe1lnWFEgL/STxs+AUcVHc/6YMsk3g13iCQdA2QJ3sc8fzL0WlyZG5sDTfOmf0VLBnQiCipuG1tPg/qp5n70ck7PTfffcYT9y/DP7e47lCeVpTSGAiVMKm27kjhhSb5RnX7BDSZnxSN29nYcjNUgfPOEup1aHuICjqvjOBZbIUvlUGtcGWASb0BgpFZw81ZwaqvgZnVfq4hCkpKgxpBOqkrwuas0ZAy3soGCPswByFf3kxB38wB8NDPU2NgTYGanouvlyGjA5d15jddQ6pbI7TDUSBfgX5lmObe7N0GYwDAPlnzhb86smStKdHFNCu/CDCggNdAD2FSIXCjMtjwwBkwkk= username@Computer-Name.local

Referencing the [RSA RFC](https://datatracker.ietf.org/doc/html/rfc8017#section-3.1), I expect to see the following in the public key file: 

| Name | Variable |
---  | --- | 
| modulus | `n` |
| publicExponent  | `e` |

This `id_rsa_hw.pub` file is not in PEM format and therefore cannot be easily decoded using the same method as the private key. To import it to PEM format, I used the following command:

```
ssh-keygen -f id_rsa_hw.pub -e -m pem > id_rsa.pub_hw.pem
```

After this command, the file was formatted like:

> -----BEGIN RSA PUBLIC KEY-----
> MIIBigKCAYEA2cfruCUsXgx6UfnuFKc9oodx/6o1JmVX/oRYj0lJRVXUBRT3tqr0
> /oUEWFJLQH2tAL4XVIG/nP6QOZFSFHyn7t1OYlaahFAxWmOIq0y/e+irTmbNGX9v
> 9V/2itd1PkmW0g4r1bfgkAa33L8ubgpj8Uo4Pq4kjCLhRvhtnQxFHtZZ1hRIC/0k
> 8bPgFHFR3P+mDLJN4Nd4gkHQNkCd7HPH8y9FpcmRubA03zpn9FSwZ0IgoqbhtbT4
> P6qeZ+9HJOz03333GE/cvwz+3uO5QnlaU0hgIlTCptu5I4YUm+UZ1+wQ0mZ8Ujdv
> Z2HIzVIHzzhLqdWh7iAo6r4zgWWyFL5VBrXBlgEm9AYKRWcPNWcGqr4GZ1X6uIQp
> KSoMaQTqpK8LmrNGQMt7KBgj7MAchX95MQd/MAfDQz1NjYE2Bmp6Lr5chowOXdeY
> 3XUOqWyO0w1EgX4F+ZZjm3uzdBmMAwD5Z84W/OrJkrSnRxTQrvwgwoIDXQA9hUiF
> wozLY8MAZMJJAgMBAAE=
> -----END RSA PUBLIC KEY-----

With this PEM formatting, I was able to paste the file into the [decoder](https://lapo.it/asn1js/), which decoded the base64 and separated the numbers into a length of 2 ANS.1 sequence. Those numbers are: 


* The modulus, `n`, is the two primes multiplied together. It is 4942271319712007060511629267369524954009153979856328868249170733762659518883204039555779518501157601924261775973735309200497484161231857797260279014732622554291967333743460534270542285560322138792559576342307077567929886182525033547497304837123743685822183064523619388747079115449222957286204134404676406578828625344133770876650291763579531228433965989115802151653502695088658803062481171341557788514807377145708007395209159911762824841744916868901296977991701680743551930960416389476860180808691039032860516495848496338328611941940491524269339553023877920855593861592463735757813567708996732231580021860988806714498474659842784047458731387214780271675709524721714752012139716622256836725386298247499677842800381728502432257208507483060325366103399705254179668207217126377078821253275633561284927388301417576728380414120008730312366195656738162428062011010242342009158894985258138671971837607392704546827950242383310778319433. 

* publicExponent, the RSA value `e`, is 65537.

***

## Sanity Check

The two primes, `p` and `q`, multiply to equal `n`:

```
>>> p*q
49422713197120070605116292673695249540091539798563288682491707337626
59518883204039555779518501157601924261775973735309200497484161231857
79726027901473262255429196733374346053427054228556032213879255957634
23070775679298861825250335474973048371237436858221830645236193887470
79115449222957286204134404676406578828625344133770876650291763579531
22843396598911580215165350269508865880306248117134155778851480737714
57080073952091599117628248417449168689012969779917016807435519309604
16389476860180808691039032860516495848496338328611941940491524269339
55302387792085559386159246373575781356770899673223158002186098880671
44984746598427840474587313872147802716757095247217147520121397166222
56836725386298247499677842800381728502432257208507483060325366103399
70525417966820721712637707882125327563356128492738830141757672838041
41200087303123661956567381624280620110102423420091588949852581386719
71837607392704546827950242383310778319433
```

This is the same number written above for modulus, or `n`. `e` is a chosen number, where a key constructed with the same primes (`p,q`) could have a different `e` chosen (for example, any other prime) which would lead to a different `d`. In order to check if the relationship between this `d` and `e` are correct, we first need `lambda_n`, which is found by doing the following:

```
>>> math.lcm(p-1,q-1)
12355678299280017651279073168423812385022884949640822170622926834406
64879720801009888944879625289400481065443993433827300124371040307964
44931506975368315563857299183343586513356763557139008053469813989408
55767693919824715456312583868743262092809359214555457661309048471867
69778862305739321551033601169101644707156336033442719162572940894882
80710849149727895053791337567377216470076562029283538944712870184428
64270018488022899779407062104362292172253242444979254190738424982784
20203196347055299828567249158763398562371759314649757907175037640359
52461582572634429978324007339891670114371987056870379056503736522797
82625629737756504550605941776546375991666135295561914310902208054038
89844854000575127795032107710871420247337952473098749739054379976682
42573123764372014206889292547938285188903452425733183149999455621698
97247077525381280684564865791871087010793091988578050753679040360126
81204000196280608947437810886622745931972
```

Now, we can test the relationship of `d` and `e`. If this key is correctly formed, then `e*d mod lambda_n = 1`. Plugging all the numbers proven so far, this relationship is found to be true:

```
>>> e*d % lambda_n 
1
```

The `e` and `n` are the same in the private and public key, so, since the numbers worked out for private key, they also do for the public. 
